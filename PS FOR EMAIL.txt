Connect-ExchangeOnline -UserPrincipalName pwilcock@fyldecoast.onmicrosoft.com


Add-MailboxPermission -Identity SHAREDMB@DOMAIN.DO -User USERMB@DOMAIN.DO -AccessRights FullAccess
Add-RecipientPermission SHAREDMB@DOMAIN.DO -AccessRights SendAs -Trustee USERMB@DOMAIN.DO

 -AutoMapping $True


Set-ExecutionPolicy RemoteSigned
Connect-ExchangeOnline -UserPrincipalName pwilcock@fyldecoast.onmicrosoft.com
$ErrorActionPreference='silentlycontinue'
Get-Mailbox -RecipientTypeDetails SharedMailbox -ResultSize:Unlimited | Get-MailboxPermission | Select-Object Identity,User,AccessRights | Select-String -Pattern Danesh.Sarfraz


$DistributionGroups= Get-DistributionGroup | where { (Get-DistributionGroupMember $_.Name | foreach {$_.PrimarySmtpAddress}) -contains "$michelle.bartlam"}


Get-Recipient -Filter "Members -eq 'CN=michelle.bartlam,OU=tenant.onmicrosoft.com,OU=Microsoft Exchange Hosted Organizations,DC=EURPR03A001,DC=prod,DC=outlook,DC=com'"
Add-DistributionGroupMember -Identity "edf.contract" -Member wayde.secker@smartchoicemetering.co.uk
Add-DistributionGroupMember -Identity "Lowri-Beck.Contracts" -Member anthony.simon@smartchoicemetering.co.uk


$DGName = "Remittances"
Get-DistributionGroupMember -Identity $DGName | Select Name, PrimarySMTPAddress |
Export-CSV "C:\Users\craig.davidson\Desktop\PS1 Scripts\Distribution-List-Members.csv" -NoTypeInformation -Encoding UTF8


Get-MailboxPermission -Identity Remittances@besutilities.co.uk | Format-List
Export-CSV "C:\Users\craig.davidson\Desktop\PS1 Scripts\Distribution-List-Members.csv" -NoTypeInformation -Encoding UTF8


Get-EXOMailbox -Filter {EmailAddresses -like "*system*"} | 
ft -Property DisplayName,RecipientType,Identity,EmailAddresses -AutoSize -Wrap